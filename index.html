<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Product</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" />
  <script src="https://unpkg.com/intasend-inlinejs-sdk@3.0.4/build/intasend-inline.js"></script>
  <script src="price.js"></script>
  <link rel="stylesheet" href="style.css">
</head>

<body oncontextmenu="return false" class="snippet-body">
  <div class="d-flex justify-content-center align-items-center container px-2">
    <div class="card">
      <div class="top d-flex flex-row align-items-center">
      </div>
      <div class="middle">
        <img src="./product.png" width="150" class="mt-3" />
        <h5>Pineapple Green Packham</h5>
        <span>Each - approx 1.2KG</span>
      </div>
      <div class="bottom d-flex flex-row justify-content-center">
        <div class="input-group mb-3">
          <span class="input-group-text" onclick="increaseQuantity()">+</span>
          <input type="text" class="form-control" value="1" id="quantity" readonly />
          <span class="input-group-text" onclick="decreaseQuantity()">-</span>
        </div>
        <button class="intaSendPayButton" data-amount="1000" data-currency="KES" id="payButton">
          Pay Now
        </button>
      </div>
    </div>
  </div>

  <script>
    const unitPrice = 1000; // Price per pineapple in KES

    function calculateBookingPrice(quantity) {
      return unitPrice * quantity;
    }

    function updatePrice() {
      const quantity = document.getElementById("quantity").value;
      const totalPrice = calculateBookingPrice(quantity);
      document.getElementById("payButton").setAttribute("data-amount", totalPrice);
      console.log(`Total price for ${quantity} pineapples: ${totalPrice} KES`);
    }

    function increaseQuantity() {
      const quantityInput = document.getElementById("quantity");
      let quantity = parseInt(quantityInput.value);
      quantity++;
      quantityInput.value = quantity;
      updatePrice();
    }

    function decreaseQuantity() {
      const quantityInput = document.getElementById("quantity");
      let quantity = parseInt(quantityInput.value);
      if (quantity > 1) {
        quantity--;
        quantityInput.value = quantity;
        updatePrice();
      }
    }

    new window.IntaSend({
      publicAPIKey: "ISPubKey_test_e70f8a4d-2f3b-4089-a095-2f28a8eab72c",
      live: false, //set to true when going live
    })
      .on("COMPLETE", (results) =>
        console.log("Do something on success", results)
      )
      .on("FAILED", (results) =>
        console.log("Do something on failure", results)
      )
      .on("IN-PROGRESS", (results) =>
        console.log("Payment in progress status", results)
      );
  </script>

</body>

</html>
